<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>
        Email Security ::
        keyboardcrunch — Tech stuff from keyboardcrunch
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="This post started as a quick note for securing email for unused domains but I decided I could expand upon it a bit more to define terms in a language I believe to be more clear than I&amp;rsquo;ve seen elsewhere, and from the view-point of an administrator or domain owner.
Index  SPF DMARC DKIM Securing Unused Domains Additional Resources  SPF Sender Policy Framework (SPF) is a method for defining domains or ips that are allowed to send email for your domain."
/>
<meta
  name="keywords"
  content="blog, personal, tech"
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://keyboardcrunch.github.io/posts/email-security/" />





<link rel="stylesheet" href="https://keyboardcrunch.github.io/assets/style.css" />

<link rel="stylesheet" href="https://keyboardcrunch.github.io/style.css" />


<link
  rel="apple-touch-icon-precomposed"
  sizes="144x144"
  href="https://keyboardcrunch.github.io/img/apple-touch-icon-144-precomposed.png"
/>
<link rel="shortcut icon" href="https://keyboardcrunch.github.io/img/favicon.png" />


<link href="https://keyboardcrunch.github.io/assets/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://keyboardcrunch.github.io/assets/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://keyboardcrunch.github.io/assets/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://keyboardcrunch.github.io/assets/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://keyboardcrunch.github.io/assets/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://keyboardcrunch.github.io/assets/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Email Security"/>
<meta name="twitter:description" content="This post started as a quick note for securing email for unused domains but I decided I could expand upon it a bit more to define terms in a language I believe to be more clear than I&rsquo;ve seen elsewhere, and from the view-point of an administrator or domain owner.
Index  SPF DMARC DKIM Securing Unused Domains Additional Resources  SPF Sender Policy Framework (SPF) is a method for defining domains or ips that are allowed to send email for your domain."/>



<meta property="og:title" content="Email Security" />
<meta property="og:description" content="This post started as a quick note for securing email for unused domains but I decided I could expand upon it a bit more to define terms in a language I believe to be more clear than I&rsquo;ve seen elsewhere, and from the view-point of an administrator or domain owner.
Index  SPF DMARC DKIM Securing Unused Domains Additional Resources  SPF Sender Policy Framework (SPF) is a method for defining domains or ips that are allowed to send email for your domain." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://keyboardcrunch.github.io/posts/email-security/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-30T14:42:21-06:00" />
<meta property="article:modified_time" content="2021-01-30T14:42:21-06:00" /><meta property="og:site_name" content="keyboardcrunch" />







  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >keyboardcrunch</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="https://github.com/keyboardcrunch/">Projects</a></li>
        
      
        
          <li><a href="https://twitter.com/keyboard_crunch/">Twitter</a></li>
        
      
      
      
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="https://github.com/keyboardcrunch/">Projects</a></li>
      
    
      
        <li><a href="https://twitter.com/keyboard_crunch/">Twitter</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title">Email Security</h1>
    <div class="post-meta">
      
        <span class="post-date">
          2021-01-30
        </span>

        
          
        
      

      


      
    </div>

    

    

    <div class="post-content">
      
      <p>This post started as a quick note for securing email for unused domains but I decided I could expand upon it a bit more to define terms in a language I believe to be more clear than I&rsquo;ve seen elsewhere, and from the view-point of an administrator or domain owner.</p>
<h2 id="index">Index</h2>
<ul>
<li><a href="#spf">SPF</a></li>
<li><a href="#dmarc">DMARC</a></li>
<li><a href="#dkim">DKIM</a></li>
<li><a href="#securing-unused-domains">Securing Unused Domains</a></li>
<li><a href="#additional-resources">Additional Resources</a></li>
</ul>
<h2 id="spf">SPF</h2>
<p>Sender Policy Framework (<a href="https://www.dmarcanalyzer.com/spf/">SPF</a>) is a method for defining domains or ips that are allowed to send email for your domain. When an email server recieves an email from your domain it will check for SPF records for your domain to confirm that the sender was authorized.</p>
<p>SPF records are often used to prevent anyone from spoofing emails from your domain, while allowing specific services to send emails on your behalf (think marketing services, zendesk, salesforce).</p>
<h3 id="example">Example</h3>
<pre><code>hostname    value
--------    -----
@           v=spf1 ip4:182.4.35.44 include:3rdpartymail.com -all
</code></pre><h3 id="explanation">Explanation</h3>
<p>Since SPF records are just text records defined for the root of the domain, they are defined with <code>v=sfp1</code> (v as in variable). <code>ip4</code> and <code>include:</code> are fairly straight forward just approved senders. The <code>all</code> flag defines how failures happen; <code>-all</code> is a &lsquo;hard&rsquo; failure to reject failures, <code>~all</code> is a &lsquo;softfail&rsquo; allowing emails to be accepted but flagged.</p>
<h2 id="dmarc">DMARC</h2>
<p>Domain-based Message Authentication, Reporting, and Conformance (<a href="https://mxtoolbox.com/dmarc/details/what-is-a-dmarc-record">DMARC</a>) is another method for defining send authority for your domain, but provides control over what happens with authentication fails (quarantine or reject) as well as being able to receive email reports for message failures.</p>
<pre><code>hostname    value
--------    -----
_dmarc.           v=DMARC1; p=reject; rua=mailto:admin@example.com;

</code></pre><h3 id="explanation-1">Explanation</h3>
<p>The above record ensures that email recipients will <code>reject</code> any emails that fail validation (<code>quarantine</code> or <code>none</code> being the alternatives) and <code>rua</code> (report email address) ensures that each failure is reported to <a href="mailto:admin@example.com">admin@example.com</a>.</p>
<h2 id="dkim">DKIM</h2>
<p>Domain Keys Identified Mail (<a href="https://postmarkapp.com/guides/dkim">DKIM</a>) provides further sender authentication to your domain through the use of public-key cryptography. When you send an email from your domain, the email will be signed by your server, and when the receiving server gets your email it will validate the signed email using the public key defined in your domain&rsquo;s DKIM TXT record. <em>This signing method isn&rsquo;t used for encrypting your messages, only domain sender verification</em>.</p>
<pre><code>hostname                            value
--------                            -----
specific._domainkey.domain.com      v=DKIM1; k=rsa; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCS
</code></pre><h3 id="explanation-2">Explanation</h3>
<p>In the above, the hostname is specific to the configuration of DKIM for your domain, and the <code>_domainkey</code> is required for discovery. As before, <code>v</code> defines the TXT value as DKIM version 1. <code>k</code> is short for key, defined above as an RSA key. <code>p</code> is the RSA public key contents (the above was truncated for brevity).</p>
<h2 id="securing-unused-domains">Securing Unused Domains</h2>
<p>If you&rsquo;re a hoarder of domains like I am, you&rsquo;ll often have domains with no custom records or default registrar records. Neither of which are particularly protected from spam and phishing attackers. Below I document the bare minimum for preventing spam or phishing using your domain.</p>
<pre><code>hostname    value
--------    -----
@           v=spf1 -all
_dmarc.     v=DMARC1; p=reject;
</code></pre><p>The above settings set a hardfail for SPF with no approved senders, essentially invalidating emails sent from your domain. Next, it defines DMARC with a policy of <code>reject</code>. If you want to receive reports for rejected emails, you can add <code>rua=mailto:youremail@domain.com;</code> to the above dmarc value string.</p>
<h2 id="additional-resources">Additional Resources</h2>
<p>The following are recommended resources for reading up on email security features and protecting your domain&rsquo;s email.</p>
<ul>
<li><a href="https://www.upguard.com/blog/the-email-security-checklist">UpGuard - The Email Security Checklist</a></li>
<li><a href="https://www.gov.uk/guidance/set-up-government-email-services-securely">UK Gov - Set up government email services securely</a></li>
</ul>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >Read other posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="https://keyboardcrunch.github.io/posts/fun-with-wireguard/">
                  <span class="button__icon">←</span>
                  <span class="button__text">Fun With Wireguard</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="https://keyboardcrunch.github.io/posts/going-static/">
                  <span class="button__text">Going Static</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">© keyboardcrunch</div>
      
  </div>
</footer>

<script src="https://keyboardcrunch.github.io/assets/main.js"></script>
<script src="https://keyboardcrunch.github.io/assets/prism.js"></script>


      
    </div>

    
  </body>
</html>
